<html>
<head>
	<title>archillect pic</title>
	<!-- link to main stylesheet -->
	<link rel="stylesheet" type="text/css" href="/css/main.css">
</head>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<body>

	<div id="img_div">
	</div>


	<script type="text/javascript">

		$( document ).ready(function() {

			sompret_image_creator("https://archillect.com/archive", "Can't get img.thumb from the site");
			
			//document.body.appendChild(image)
			//document.getElementById("demo").innerHTML = image;


		});

		//https://stackoverflow.com/questions/21138707/get-image-src-from-external-url-using-jquery

		function sompret_image_creator(url, ptitle)
		{
			
			
			
			
			
			
			
			
			
			
			
			var html_content = "";
			
			
			
			
			//https://robwu.nl/cors-anywhere.html
			var cors_api_url = 'https://cors-anywhere.herokuapp.com/';
			function doCORSRequest(options, printResult) {
			var x = new XMLHttpRequest();
				x.open(options.method, cors_api_url + options.url);
				x.onload = x.onerror = function() {
					printResult(
						
						(x.responseText || '')
					);
				};
				if (/^POST/i.test(options.method)) {
					x.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
				}
				x.send(options.data);
			}
			
			// Bind event


			(function (e) {


			
				e.preventDefault();
				doCORSRequest({
					method: 'GET',
					url: url,
					data: ''
				}, function printResult(result) {
					html_content = result;
				});
			})();



			if (typeof console === 'object') {
				console.log('// To test a local CORS Anywhere server, set cors_api_url. For example:');
				console.log('cors_api_url = "http://localhost:8080/"');
			}
			
			
			
			
			
			
			
			
			var html = $.parseHTML( html_content ), 
			img = $(html).find("img.thumb"),
			len = img.length; 
			if( len > 0 ){
				var src = img.first().attr("src"); // get id of first image
			} else {
				console.log("Image not found");
			}
			console.log(src);

			image_tag='<img src="'+src+'" alt="'+ptitle+'"/>';

			$("div.image").prepend(image_tag);
			//document.getElementById("img_div").innerHTML = image_tag

				
			
		}
			
			
			
			



	</script>



</body>
</html>
